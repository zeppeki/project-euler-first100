# Problem 016: Power Digit Sum

## 問題

2^15 = 32768 であり、その各桁の数字の和は 3 + 2 + 7 + 6 + 8 = 26 です。

2^1000 の各桁の数字の和はいくつでしょうか？

## 解答

Project Euler公式サイトで確認してください。

## 解法

### 1. 素直な解法 (solve_naive)

```python
def solve_naive(power: int) -> int:
    """
    素直な解法
    2^powerを計算し、各桁の数字の和を求める

    時間計算量: O(power * log(2^power)) = O(power^2)
    空間計算量: O(power)
    """
    # 2^powerを計算
    result = 2 ** power

    # 各桁の数字の和を計算
    digit_sum = 0
    while result > 0:
        digit_sum += result % 10
        result //= 10

    return digit_sum
```

**特徴:**
- 2^powerを直接計算
- 剰余演算（%）と整数除算（//）を使用して各桁を取得
- 最も直感的で理解しやすい解法

**計算量:**
- 時間計算量: O(power^2) - 大きな数の計算と桁の処理
- 空間計算量: O(power) - 大きな数を格納するため

### 2. 最適化解法 (solve_optimized)

```python
def solve_optimized(power: int) -> int:
    """
    最適化解法
    文字列変換を使用して桁の和を計算

    時間計算量: O(power * log(2^power)) = O(power^2)
    空間計算量: O(power)
    """
    # 2^powerを計算して文字列に変換
    result = str(2 ** power)

    # 各桁の数字の和を計算
    return sum(int(digit) for digit in result)
```

**特徴:**
- 文字列変換を活用して桁の和を計算
- リスト内包表記で簡潔に実装
- Pythonの組み込み関数を最大限活用

**最適化のポイント:**
- 文字列変換による効率的な桁の取得
- `sum()`関数とリスト内包表記の組み合わせ
- 可読性とパフォーマンスのバランス

### 3. 数学的解法 (solve_mathematical)

```python
def solve_mathematical(power: int) -> int:
    """
    数学的解法
    大きな数の計算を効率化し、桁の和を計算

    時間計算量: O(power * log(2^power)) = O(power^2)
    空間計算量: O(power)
    """
    # 2^powerを計算（Pythonの組み込みの大きな数処理を活用）
    result = pow(2, power)

    # 文字列変換で桁の和を計算（最も効率的）
    return sum(int(digit) for digit in str(result))
```

**特徴:**
- `pow()`関数を使用した効率的な累乗計算
- Pythonの組み込みの大きな数処理を活用
- 数学的アプローチの実装

**数学的背景:**
- 大きな数の累乗計算の最適化
- 桁の和の数学的性質の活用

## 数学的背景

### 大きな数の性質

2^1000は非常に大きな数で、約302桁の数字になります：

```
2^1000 ≈ 1.07 × 10^301
```

### 桁の和の性質

- **桁の和の範囲**: n桁の数の桁の和は最大で9n
- **2の累乗の桁の和**: 必ずしも単調増加しない
  - 例: 2^4 = 16 → 1+6 = 7
  - 例: 2^5 = 32 → 3+2 = 5

### 計算の効率化

この問題では、数学的な最適化の余地は限定的ですが、以下の点で効率化が可能です：

1. **大きな数の処理**: Pythonの組み込みの大きな数処理を活用
2. **桁の和の計算**: 文字列変換による効率的な処理
3. **メモリ効率**: 必要最小限のメモリ使用

## 検証

- **入力:** 2^15
- **解答:** [隠匿]
- **検証:** ✓

### テストケース

| 入力 | 期待値 | 説明 |
|------|--------|------|
| 2^0 | 1 | 2^0 = 1 → 1 |
| 2^1 | 2 | 2^1 = 2 → 2 |
| 2^2 | 4 | 2^2 = 4 → 4 |
| 2^3 | 8 | 2^3 = 8 → 8 |
| 2^4 | 7 | 2^4 = 16 → 1+6 = 7 |
| 2^5 | 5 | 2^5 = 32 → 3+2 = 5 |
| 2^10 | 7 | 2^10 = 1024 → 1+0+2+4 = 7 |
| 2^15 | 26 | 2^15 = 32768 → 3+2+7+6+8 = 26 |

## パフォーマンス比較

### 実行時間比較

| 解法 | 実行時間 | 相対速度 |
|------|----------|----------|
| 素直な解法 | ~0.001秒 | 1.0x |
| 最適化解法 | ~0.001秒 | 1.0x |
| 数学的解法 | ~0.001秒 | 1.0x |

### メモリ使用量

すべての解法で同程度のメモリ使用量（O(power)）です。

## 最適化のポイント

### 1. 大きな数の処理
- Pythonの組み込みの大きな数処理を活用
- メモリ効率を考慮した実装

### 2. 桁の和の計算
- 文字列変換による効率的な処理
- リスト内包表記の活用

### 3. アルゴリズムの選択
- 問題の性質に応じた適切な解法の選択
- 可読性とパフォーマンスのバランス

## 学習ポイント

### 1. 大きな数の処理
- Pythonの組み込みの大きな数処理の理解
- メモリ効率を考慮した実装方法

### 2. 桁の和の計算
- 複数のアプローチ（剰余演算 vs 文字列変換）
- 各アプローチの利点と欠点

### 3. アルゴリズム設計
- 問題の性質に応じた解法の選択
- 計算量の分析と最適化

### 4. テスト設計
- エッジケースの考慮
- 数学的正確性の検証

## 参考

- [Project Euler Problem 16](https://projecteuler.net/problem=16)
- [Python Big Integer Operations](https://docs.python.org/3/library/decimal.html)
- [Digit Sum Algorithms](https://en.wikipedia.org/wiki/Digit_sum)
- [Big Number Arithmetic](https://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic)
